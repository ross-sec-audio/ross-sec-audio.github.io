---
title: Vulnerability Management in 4 Stages
date: 2022-06-06
tags: [infosec, vulnerability]     # TAG names should always be lowercase
excerpt_separator: <!--more-->
image:
  src: /assets/img/imgs/colour_banner.png
  width: 1000   # in pixels
  height: 200   # in pixels
  alt: abstract banner
---

>Well, running a periodic Nessus scan on some of your organisation's stuff ain't it.
<!--more-->

## What is Vulnerability Management?
It's a lifecycle of tools, team collaboration and processes, including: 
1. Periodic/continuous scanning of all your organisation's assets using various tools
2. Informed measurement and prioritisation of findings from these tools
3. The remediation of those findings through collaboration with various teams
4. The verification that those remediation actions worked 

5. Extra Bonus Stage - Doing it all again because it‚Äôs a continuous virtuous cycle

This blog post is a rant about each of these steps.

### Caveat
While I've some experience of setting up and running vulnerability management programmes, I'm in no way an expert and these are just my thoughts. If I've made any mistakes or omitted anything important I'd love to know. I'm keen to continually learn more üòÄ 

This is where I harp on about the importance of asset management as the foundation for all other InfoSec functions. 

## Coverage

If you don‚Äôt have a good understanding of your assets (e.g. your endpoint devices, mobile devices, servers, infrastructure components, code repos, data centres, 3rd party vendors, etc.), what their ‚Äúbill of materials‚Äù includes and how they're being used by your staff and customers, you‚Äôll struggle to secure them. 

IMAGE

The same goes for vulnerability management. If you‚Äôre only scanning a portion of your assets, you‚Äôll get a false sense of security when some tool reports that you have n number of critical vulnerabilities. 

Getting 100% coverage is hard though. It often requires multiple tools, each fulfilling a different function.

Examples of vulnerability tool types include:
- Static Analysis Security Testing (SAST) solutions - These search for vulnerabilities in your code base. OWASP includes a good list of SAST tools here: https://owasp.org/www-community/Source_Code_Analysis_Tools
- Dynamic Analysis Security Testing (DAST) solutions - These search for vulnerabilities in your applications during runtime. [OWASP ZAP](https://www.zaproxy.org/ "OWASP ZAP") is a full featured free and open source DAST tool.
- Software Composition Analysis (SCA) solutions - These search for vulnerabilities in open source packages and components that are included or imported into your applications (think Log4J). [Github](https://github.com/features/security/software-supply-chain "Github") & [Snyk](https://snyk.io/product/open-source-security-management/ "Snyk") both include easy to use SCA features.
- Network Vulnerability Scanning solutions - These scan networks and connected devices/servers for vulnerabilities. [OpenVAS](https://github.com/greenbone/openvas-scanner "OpenVAS") is a nice and flexible open source vulnerability scanner.
- Interactive Application Security Testing (IAST) solutions - Through installed agents, these test applications at runtime while analysing the relevant source code to identify more vulnerabilities with a lower rate of false positives. DZone has a great article going into further detail about IAST [here](https://dzone.com/refcardz/introduction-to-iast "here").
- Pen. Testing - an authorised security exercise where a cyber-security expert attempts to actively find and exploit vulnerabilities in an application.

These tools and methods can either be used as a part of a software development pipeline, to ensure that a deployed product is secure by design, or as an operational ‚Äúbusiness as usual‚Äù service, run by your security assurance team, to find and fix vulnerabilities in already existing and live assets.

I think the trick is to understand what assets your organisation already has in place and what they‚Äôre planning on developing/procuring in the near future. Then you can begin to explore various options to implement vulnerability management tooling or processes that fit your organisation's threats.

Ideally you‚Äôd want to scan everything all the time, but that's not always easy.

## Continuous scanning of everything

How realistic is this? It depends. But that caveat doesn't change the goal: You want to continually have an up to date picture of the security posture of all your assets. With that full picture you can prioritise effectively and reduce your organisation‚Äôs risk exposure.

My recommendation here is to go have a friendly and empathetic chat with your architecture, development, test and operations teams to figure out what will and won't work for them. 

This could include discussions about tooling that works for those teams, while also achieving adequate coverage. Ideally you don't want to ask a team to use tools they hate, so instead you could ask them to try a few and see what works for everyone.

One thing to keep in mind is the Load implications of running a vulnerability scanning tool continuously. Testing is key here as you‚Äôll need to identify what you can do without breaking your organisation's technology and processes. Again it‚Äôs recommended that you chat with relevant technical leads, so you don‚Äôt end up DoSing your own systems.

### Continuous scanning all the time, or every once in a while?

It's generally not recommended to only check for vulnerabilities in your assets once a year, but sometimes a periodic scan is the most pragmatic approach. If you can get that period to occur often, like once a month, you‚Äôll get lots of benefits. Firstly you‚Äôll get the obvious benefit of having more visibility as your assets change over time, but you‚Äôll also keep your architecture, development, test and operations teams happy (after the initial wave of vulnerabilities you find after the first scan üò≠). 

Instead of sharing a list of thousands of significant vulnerabilities once a year, you can continually work with teams and support them to address findings on an on-going basis. This allows them to bake remediation, configuration updates and patch management practices into their technical backlogs, business as usual workloads and capacity management.

## Prioritisation

After you‚Äôve run some scans, you‚Äôll soon realise that you‚Äôve identified too many to fix at once. This is pretty common and requires some planning to confirm which vulnerabilities should be remediated and addressed first.

CVSS scores are incredibly useful in helping organisations to effectively prioritise their vulnerabilities. They are derived from various metrics which can be used to help understand a given score's relevance in your own context. Metrics include Attack Vector (AV) and Attach Complexity (AC).

The following is a list of metrics used in CVSS v3.1:

#### Base Score Metrics
 - Attack Vector (AV) 
    - Network (AV:N) 
    - Adjacent Network (AV:A)
    - Local (AV:L)
    - Physical (AV:P)
 - Attack Complexity (AC)
    - Low (AC:L)
    - High (AC:H)
 - Privileges Required (PR)
    - None (PR:N)
    - Low (PR:L)
    - High (PR:H)
 - User Interaction (UI)
    - None (UI:N)
    - Required (UI:R)
 - Scope (S)
    - Unchanged (S:U)
    - Changed (S:C)
#### Impact Metrics
 - Confidentiality Impact
    - None (C:N)
    - Low (C:L)
    - High (C:H)
 - Integrity Impact (I)
    - None (I:N)
    - Low (I:L)
    - High (I:H)
 - Availability Impact (A)
    - None (A:N)
    - Low (A:L)
    - High (A:H)
